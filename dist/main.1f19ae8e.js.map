{"version":3,"sources":["main.js"],"names":["canvas","document","getElementById","width","documentElement","clientWidth","height","clientHeight","ctx","getContext","strokeStyle","lastsStrokeStyle","lineWidth","lineCap","painting","historyDeta","saveData","data","length","shift","push","last","drawLine","x1","y1","x2","y2","beginPath","moveTo","lineTo","stroke","isTouchDevice","ontouchstart","e","touches","clientX","clientY","ontouchmove","onmousedown","firstDot","getImageData","onmousemove","onmouseup","wrapperBut","addEventListener","console","log","target","tagName","type","id","save","setTransform","clearRect","restore","putImageData","pop","imgUrl","toDataURL","saveA","createElement","body","appendChild","href","download","Date","getTime","click","value"],"mappings":"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","file":"main.1f19ae8e.js","sourceRoot":"..","sourcesContent":["//获取canvas节点\r\nlet canvas = document.getElementById(\"canvas\")\r\n//尺寸自适应屏幕\r\ncanvas.width = document.documentElement.clientWidth\r\ncanvas.height = document.documentElement.clientHeight\r\n//设置点类型\r\nlet ctx = canvas.getContext(\"2d\")\r\n//设置线样式\r\nctx.strokeStyle = \"black\"\r\n//记录上次画笔\r\nlet lastsStrokeStyle\r\n//设置线宽度\r\nctx.lineWidth = 5\r\n//设置圆角接口\r\nctx.lineCap = \"round\"\r\n\r\n//声明开启/关闭\r\nlet painting = false\r\n\r\n//位置数据列表\r\nlet historyDeta = [];\r\n//保存数据\r\nfunction saveData(data) {\r\n    (historyDeta.length === 10) && (historyDeta.shift()); // 上限为储存10步，太多了怕挂掉\r\n    historyDeta.push(data);\r\n}\r\n\r\n//记录上次位置数据\r\nlet last\r\n//声明画线函数\r\nfunction drawLine(x1, y1, x2, y2) {\r\n    ctx.beginPath()\r\n    ctx.moveTo(x1, y1)\r\n    ctx.lineTo(x2, y2)\r\n    ctx.stroke()\r\n}\r\n\r\n// 获取是否触摸\r\nlet isTouchDevice = \"ontouchstart\" in document.documentElement\r\n\r\n//绘制一个填充了内容的圆形\r\nif (isTouchDevice) {    //移动端\r\n    canvas.ontouchstart = (e) => {\r\n        last = [e.touches[0].clientX, e.touches[0].clientY]\r\n        painting = true\r\n    }\r\n    canvas.ontouchmove = (e) => {\r\n\r\n        if (painting === true) {\r\n            drawLine(last[0], last[1], e.touches[0].clientX, e.touches[0].clientY)\r\n            last = [e.touches[0].clientX, e.touches[0].clientY]\r\n        } else {\r\n            // console.log(\"停止\")\r\n        }\r\n    }\r\n} else {   //PC端\r\n    canvas.onmousedown = (e) => {\r\n        painting = true\r\n        last = [e.clientX, e.clientY]\r\n\r\n        // 在这里储存绘图表面\r\n        let firstDot\r\n        firstDot = ctx.getImageData(0, 0, canvas.width, canvas.height);\r\n        saveData(firstDot);\r\n\r\n\r\n    }\r\n    canvas.onmousemove = (e) => {\r\n        if (painting === true) {\r\n            // console.log(last);\r\n            drawLine(last[0], last[1], e.clientX, e.clientY)\r\n\r\n            last = [e.clientX, e.clientY]\r\n        } else {\r\n            // console.log(\"停止\")\r\n\r\n        }\r\n    }\r\n    canvas.onmouseup = () => {\r\n        painting = false\r\n    }\r\n}\r\n\r\n// let whiteBut = document.getElementById(\"white\")\r\n// whiteBut.addEventListener('click', () => {\r\n//     //设置线样式\r\n//     ctx.strokeStyle = \"white\"\r\n// })\r\n// let blackBut = document.getElementById(\"black\")\r\n// blackBut.addEventListener('click', () => {\r\n//     //设置线样式\r\n//     ctx.strokeStyle = \"black\"\r\n// })\r\n// let redBut = document.getElementById(\"red\")\r\n// redBut.addEventListener('click', () => {\r\n//     //设置线样式\r\n//     ctx.strokeStyle = \"red\"\r\n// })\r\n\r\n\r\n//事不过三\r\nlet wrapperBut = document.getElementById(\"wrapper\")\r\nwrapperBut.addEventListener('click', (e) => {\r\n    console.log(e.target.tagName);\r\n    if (e.target.type === 'submit') {\r\n\r\n        ctx.strokeStyle = e.target.id\r\n        lastsStrokeStyle = e.target.id\r\n\r\n    } else if (e.target.tagName === 'BUTTON' || e.target.tagName === 'svg' || e.target.tagName === 'use') {\r\n       \r\n        switch (e.target.id) {\r\n            case '画笔':\r\n                console.log('选择画笔');\r\n                ctx.strokeStyle = lastsStrokeStyle\r\n                break;\r\n            case '橡皮':\r\n                console.log('选择橡皮');\r\n                ctx.strokeStyle = 'white'\r\n\r\n                break;\r\n            case '清除':\r\n                console.log('选择清除');\r\n                ctx.save();\r\n                ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n                ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n                ctx.restore();\r\n                break;\r\n            case '撤回':\r\n                console.log('选择撤回');\r\n                if (historyDeta.length < 1) return false;\r\n                ctx.putImageData(historyDeta[historyDeta.length - 1], 0, 0);\r\n                historyDeta.pop()\r\n                break;\r\n            case '保存':\r\n                console.log('选择保存');\r\n                let imgUrl = canvas.toDataURL(\"image/png\");\r\n                let saveA = document.createElement(\"a\");\r\n                document.body.appendChild(saveA);\r\n                saveA.href = imgUrl;\r\n                saveA.download = \"zspic\" + (new Date).getTime();\r\n                saveA.target = \"_blank\";\r\n                saveA.click();\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n    } else {\r\n        ctx.lineWidth = e.target.value //8\r\n    }\r\n\r\n})\r\n\r\n"]}